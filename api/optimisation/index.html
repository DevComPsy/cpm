<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>cpm.optimisation - CPM library</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/_mkdocstrings.css" rel="stylesheet" />
        <link href="../../style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "cpm.optimisation";
        var mkdocs_page_input_path = "api/optimisation.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/json.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/markdown.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/makefile.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> CPM library
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/">Troubleshooting</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../roadmap/">Roadmap</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Examples</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/associative-learning/">Two associative learning models and blocking (cpm.models, cpm.generators)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/bandit-task/">Reinforcement learning with a two-armed bandit (cpm.models, cpm.generators, cpm.optimisation)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/metacognition/">Estimating metacognitive efficiency with meta-d (cpm.applications)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/model-parameter-recovery/">Parameter Recovery (cpm.generators, cpm.models, cpm.optimisation)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/model-recovery/">Model Recovery and Landscaping (cpm.models, cpm.generators, cpm.optimisation)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/fitting-hierarchical-estimation/">Estimating Empirical Priors (cpm.hierarchical)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/fitting-hierarchical/">Exploring hierarchical estimation of hyperparameters (cpm.hierarchical)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../examples/hpc-example/">Scale to hypercomputing cluster</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../applications/">cpm.applications</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../datasets/">cpm.datasets</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../models/">cpm.models</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../generators/">cpm.generators</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">cpm.optimisation</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#cpm.optimisation.DifferentialEvolution">DifferentialEvolution</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.DifferentialEvolution.export">export</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.DifferentialEvolution.optimise">optimise</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.DifferentialEvolution.reset">reset</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cpm.optimisation.Fmin">Fmin</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.Fmin.export">export</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.Fmin.optimise">optimise</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.Fmin.reset">reset</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cpm.optimisation.FminBound">FminBound</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.FminBound.export">export</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.FminBound.optimise">optimise</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.FminBound.reset">reset</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cpm.optimisation.Minimize">Minimize</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.Minimize.export">export</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.Minimize.optimise">optimise</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.Minimize.reset">reset</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cpm.optimisation.Bads">Bads</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.Bads.export">export</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.Bads.optimise">optimise</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.Bads.reset">reset</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#minimise">minimise</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.minimise.LogLikelihood">LogLikelihood</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#cpm.optimisation.minimise.LogLikelihood.bernoulli">bernoulli</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cpm.optimisation.minimise.LogLikelihood.categorical">categorical</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cpm.optimisation.minimise.LogLikelihood.continuous">continuous</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cpm.optimisation.minimise.LogLikelihood.multinomial">multinomial</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cpm.optimisation.minimise.LogLikelihood.product">product</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.minimise.Distance">Distance</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#cpm.optimisation.minimise.Distance.MSE">MSE</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cpm.optimisation.minimise.Distance.RMSE">RMSE</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cpm.optimisation.minimise.Distance.SSE">SSE</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#cpm.optimisation.minimise.Bayesian">Bayesian</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#cpm.optimisation.minimise.Bayesian.AIC">AIC</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cpm.optimisation.minimise.Bayesian.BIC">BIC</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../hierarchical/">cpm.hierarchical</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../utils/">cpm.utils</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">CPM library</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Reference</li>
      <li class="breadcrumb-item active">cpm.optimisation</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="cpmoptimisation">cpm.optimisation</h1>


<div class="doc doc-object doc-class">



<h2 id="cpm.optimisation.DifferentialEvolution" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">cpm</span><span class="o">.</span><span class="n">optimisation</span><span class="o">.</span><span class="n">DifferentialEvolution</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minimisation</span><span class="o">=</span><span class="n">minimise</span><span class="o">.</span><span class="n">LogLikelihood</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">],</span> <span class="n">ppt_identifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">


        <p>Class representing the Differential Evolution optimization algorithm.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>model</code></b>
                  (<code><span title="cpm.cpm.generators.Wrapper">Wrapper</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The model to be optimized.</p>
              </div>
            </li>
            <li>
              <b><code>data</code></b>
                  (<code>(<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.DataFrameGroupBy">DataFrameGroupBy</span>, <span title="list">list</span>)</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The data used for optimization. If a pd.Dataframe, it is grouped by the <code>ppt_identifier</code>. If it is a pd.DataFrameGroupby, groups are assumed to be participants. An array of dictionaries, where each dictionary contains the data for a single participant, including information about the experiment and the results too. See Notes for more information.</p>
              </div>
            </li>
            <li>
              <b><code>minimisation</code></b>
                  (<code><span title="function">function</span></code>, default:
                      <code><a class="autorefs autorefs-internal" title="bernoulli(predicted=None, observed=None, negative=True, **kwargs)

  
      staticmethod
   (cpm.optimisation.minimise.LogLikelihood.bernoulli)" href="#cpm.optimisation.minimise.LogLikelihood.bernoulli">bernoulli</a></code>
)
              –
              <div class="doc-md-description">
                <p>The loss function for the objective minimization function. Default is <code>minimise.LogLikelihood.bernoulli</code>. See the <code>minimise</code> module for more information. User-defined loss functions are also supported, but they must conform to the format of currently implemented ones.</p>
              </div>
            </li>
            <li>
              <b><code>prior</code></b>
              –
              <div class="doc-md-description">
                <p>Whether to include priors in the optimisation. Deafult is 'False'.</p>
              </div>
            </li>
            <li>
              <b><code>parallel</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to use parallel processing. Default is <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>cl</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The number of cores to use for parallel processing. Default is <code>None</code>. If <code>None</code>, the number of cores is set to 2.
If <code>cl</code> is set to <code>None</code> and <code>parallel</code> is set to <code>True</code>, the number of cores is set to the number of cores available on the machine.</p>
              </div>
            </li>
            <li>
              <b><code>libraries</code></b>
                  (<code><span title="list">list</span></code>, default:
                      <code>[&#39;numpy&#39;, &#39;pandas&#39;]</code>
)
              –
              <div class="doc-md-description">
                <p>The libraries to import for parallel processing for <code>ipyparallel</code> with the IPython kernel. Default is <code>["numpy", "pandas"]</code></p>
              </div>
            </li>
            <li>
              <b><code>ppt_identifier</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The key in the participant data dictionary that contains the participant identifier. Default is <code>None</code>. Returned in the optimization details.</p>
              </div>
            </li>
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="dict">dict</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments. See the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.differential_evolution.html"><code>scipy.optimize.differential_evolution</code></a> documentation for what is supported.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p>The data parameter must contain all input to the model, including the observed data. The data parameter can be a pandas DataFrame, a pandas DataFrameGroupBy object, or a list of dictionaries. If the data parameter is a pandas DataFrame, it is assumed that the data needs to be grouped by the participant identifier, <code>ppt_identifier</code>. If the data parameter is a pandas DataFrameGroupBy object, the groups are assumed to be participants. If the data parameter is a list of dictionaries, each dictionary should contain the data for a single participant, including information about the experiment and the results. The observed data for each participant should be included in the dictionary under the key or column 'observed'. The 'observed' key should correspond, both in format and shape, to the 'dependent' variable calculated by the model Wrapper.</p>
</details>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.DifferentialEvolution.export" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export</span><span class="p">(</span><span class="n">details</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exports the optimization results and fitted parameters as a <code>pandas.DataFrame</code>.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>details</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to include the various metrics related to the optimisation routine in the output.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
              –
              <div class="doc-md-description">
                <p>A pandas DataFrame containing the optimization results and fitted parameters. If <code>details</code> is <code>True</code>, the DataFrame will also include the optimization details.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p>The DataFrame will not contain the population and population_energies keys from the optimization details.
If you want to investigate it, please use the <code>details</code> attribute.</p>
</details>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.DifferentialEvolution.optimise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimise</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Performs the optimization process.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>None</code>
              –
              <div class="doc-md-description">
                
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.DifferentialEvolution.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Resets the optimization results and fitted parameters.</p>
<p>Returns:
- None</p>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="cpm.optimisation.Fmin" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">cpm</span><span class="o">.</span><span class="n">optimisation</span><span class="o">.</span><span class="n">Fmin</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_guess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minimisation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">],</span> <span class="n">prior</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">number_of_starts</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ppt_identifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">


        <p>Class representing the Fmin search (unbounded) optimization algorithm using a downhill simplex.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>model</code></b>
                  (<code><span title="cpm.cpm.generators.Wrapper">Wrapper</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The model to be optimized.</p>
              </div>
            </li>
            <li>
              <b><code>data</code></b>
                  (<code>(<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.DataFrameGroupBy">DataFrameGroupBy</span>, <span title="list">list</span>)</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The data used for optimization. If a pd.Dataframe, it is grouped by the <code>ppt_identifier</code>. If it is a pd.DataFrameGroupby, groups are assumed to be participants. An array of dictionaries, where each dictionary contains the data for a single participant, including information about the experiment and the results too. See Notes for more information.</p>
              </div>
            </li>
            <li>
              <b><code>minimisation</code></b>
                  (<code><span title="function">function</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The loss function for the objective minimization function. See the <code>minimise</code> module for more information. User-defined loss functions are also supported.</p>
              </div>
            </li>
            <li>
              <b><code>prior</code></b>
              –
              <div class="doc-md-description">
                <p>Whether to include the prior in the optimization. Default is <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>number_of_starts</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>The number of random initialisations for the optimization. Default is <code>1</code>.</p>
              </div>
            </li>
            <li>
              <b><code>initial_guess</code></b>
                  (<code><span title="list">list</span> or <span title="array">array</span> - <span title="like">like</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The initial guess for the optimization. Default is <code>None</code>. If <code>number_of_starts</code> is set, and the <code>initial_guess</code> parameter is 'None', the initial guesses are randomly generated from a uniform distribution.</p>
              </div>
            </li>
            <li>
              <b><code>parallel</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to use parallel processing. Default is <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>cl</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The number of cores to use for parallel processing. Default is <code>None</code>. If <code>None</code>, the number of cores is set to 2.
If <code>cl</code> is set to <code>None</code> and <code>parallel</code> is set to <code>True</code>, the number of cores is set to the number of cores available on the machine.</p>
              </div>
            </li>
            <li>
              <b><code>libraries</code></b>
                  (<code><span title="list">list</span></code>, default:
                      <code>[&#39;numpy&#39;, &#39;pandas&#39;]</code>
)
              –
              <div class="doc-md-description">
                <p>The libraries to import for parallel processing for <code>ipyparallel</code> with the IPython kernel. Default is <code>["numpy", "pandas"]</code>.</p>
              </div>
            </li>
            <li>
              <b><code>ppt_identifier</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The key in the participant data dictionary that contains the participant identifier. Default is <code>None</code>. Returned in the optimization details.</p>
              </div>
            </li>
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="dict">dict</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments. See the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin.html"><code>scipy.optimize.fmin</code></a> documentation for what is supported.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p>The data parameter must contain all input to the model, including the observed data. The data parameter can be a pandas DataFrame, a pandas DataFrameGroupBy object, or a list of dictionaries. If the data parameter is a pandas DataFrame, it is assumed that the data needs to be grouped by the participant identifier, <code>ppt_identifier</code>. If the data parameter is a pandas DataFrameGroupBy object, the groups are assumed to be participants. If the data parameter is a list of dictionaries, each dictionary should contain the data for a single participant, including information about the experiment and the results. The observed data for each participant should be included in the dictionary under the key or column 'observed'. The 'observed' key should correspond, both in format and shape, to the 'dependent' variable calculated by the model Wrapper.</p>
<p>The optimization process is repeated <code>number_of_starts</code> times, and only the best-fitting output from the best guess is stored.</p>
</details>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.Fmin.export" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exports the optimization results and fitted parameters as a <code>pandas.DataFrame</code>.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
              –
              <div class="doc-md-description">
                <p>A pandas DataFrame containing the optimization results and fitted parameters.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.Fmin.optimise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimise</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Performs the optimization process.</p>
<p>Returns:
- None</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.Fmin.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">(</span><span class="n">initial_guess</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Resets the optimization results and fitted parameters.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>initial_guess</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to reset the initial guess (generates a new set of random numbers within parameter bounds). Default is <code>True</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>None</code>
              –
              <div class="doc-md-description">
                
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="cpm.optimisation.FminBound" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">cpm</span><span class="o">.</span><span class="n">optimisation</span><span class="o">.</span><span class="n">FminBound</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_guess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_starts</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">minimisation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">],</span> <span class="n">prior</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ppt_identifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">


        <p>Class representing the Fmin search (bounded) optimization algorithm using the L-BFGS-B method.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>model</code></b>
                  (<code><span title="cpm.cpm.generators.Wrapper">Wrapper</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The model to be optimized.</p>
              </div>
            </li>
            <li>
              <b><code>data</code></b>
                  (<code>(<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.DataFrameGroupBy">DataFrameGroupBy</span>, <span title="list">list</span>)</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The data used for optimization. If a pd.Dataframe, it is grouped by the <code>ppt_identifier</code>. If it is a pd.DataFrameGroupby, groups are assumed to be participants. An array of dictionaries, where each dictionary contains the data for a single participant, including information about the experiment and the results too. See Notes for more information.</p>
              </div>
            </li>
            <li>
              <b><code>minimisation</code></b>
                  (<code><span title="function">function</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The loss function for the objective minimization function. See the <code>minimise</code> module for more information. User-defined loss functions are also supported.</p>
              </div>
            </li>
            <li>
              <b><code>prior</code></b>
              –
              <div class="doc-md-description">
                <p>Whether to include the prior in the optimization. Default is <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>number_of_starts</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>The number of random initialisations for the optimization. Default is <code>1</code>.</p>
              </div>
            </li>
            <li>
              <b><code>initial_guess</code></b>
                  (<code><span title="list">list</span> or <span title="array">array</span> - <span title="like">like</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The initial guess for the optimization. Default is <code>None</code>. If <code>number_of_starts</code> is set, and the <code>initial_guess</code> parameter is 'None', the initial guesses are randomly generated from a uniform distribution.</p>
              </div>
            </li>
            <li>
              <b><code>parallel</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to use parallel processing. Default is <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>cl</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The number of cores to use for parallel processing. Default is <code>None</code>. If <code>None</code>, the number of cores is set to 2.
If <code>cl</code> is set to <code>None</code> and <code>parallel</code> is set to <code>True</code>, the number of cores is set to the number of cores available on the machine.</p>
              </div>
            </li>
            <li>
              <b><code>libraries</code></b>
                  (<code><span title="list">list</span></code>, default:
                      <code>[&#39;numpy&#39;, &#39;pandas&#39;]</code>
)
              –
              <div class="doc-md-description">
                <p>The libraries to import for parallel processing for <code>ipyparallel</code> with the IPython kernel. Default is <code>["numpy", "pandas"]</code>.</p>
              </div>
            </li>
            <li>
              <b><code>ppt_identifier</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The key in the participant data dictionary that contains the participant identifier. Default is <code>None</code>. Returned in the optimization details.</p>
              </div>
            </li>
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="dict">dict</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments. See the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin_l_bfgs_b.html"><code>scipy.optimize.fmin_l_bfgs_b</code></a> documentation for what is supported.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p>The data parameter must contain all input to the model, including the observed data. The data parameter can be a pandas DataFrame, a pandas DataFrameGroupBy object, or a list of dictionaries. If the data parameter is a pandas DataFrame, it is assumed that the data needs to be grouped by the participant identifier, <code>ppt_identifier</code>. If the data parameter is a pandas DataFrameGroupBy object, the groups are assumed to be participants. If the data parameter is a list of dictionaries, each dictionary should contain the data for a single participant, including information about the experiment and the results. The observed data for each participant should be included in the dictionary under the key or column 'observed'. The 'observed' key should correspond, both in format and shape, to the 'dependent' variable calculated by the model Wrapper.</p>
<p>The optimization process is repeated <code>number_of_starts</code> times, and only the best-fitting output from the best guess is stored.</p>
</details>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.FminBound.export" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exports the optimization results and fitted parameters as a <code>pandas.DataFrame</code>.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
              –
              <div class="doc-md-description">
                <p>A pandas DataFrame containing the optimization results and fitted parameters.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.FminBound.optimise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimise</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Performs the optimization process.</p>
<p>Returns:
- None</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.FminBound.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">(</span><span class="n">initial_guess</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Resets the optimization results and fitted parameters.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>initial_guess</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to reset the initial guess (generates a new set of random numbers within parameter bounds). Default is <code>True</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>None</code>
              –
              <div class="doc-md-description">
                
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="cpm.optimisation.Minimize" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">cpm</span><span class="o">.</span><span class="n">optimisation</span><span class="o">.</span><span class="n">Minimize</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initial_guess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minimisation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Nelder-Mead&#39;</span><span class="p">,</span> <span class="n">cl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">],</span> <span class="n">prior</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">number_of_starts</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ppt_identifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">


        <p>Class representing scipy's Minimize algorithm wrapped for subject-level parameter estimations.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>model</code></b>
                  (<code><span title="cpm.cpm.generators.Wrapper">Wrapper</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The model to be optimized.</p>
              </div>
            </li>
            <li>
              <b><code>data</code></b>
                  (<code>(<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.DataFrameGroupBy">DataFrameGroupBy</span>, <span title="list">list</span>)</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The data used for optimization. If a pd.Dataframe, it is grouped by the <code>ppt_identifier</code>. If it is a pd.DataFrameGroupby, groups are assumed to be participants. An array of dictionaries, where each dictionary contains the data for a single participant, including information about the experiment and the results too. See Notes for more information.</p>
              </div>
            </li>
            <li>
              <b><code>minimisation</code></b>
                  (<code><span title="function">function</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The loss function for the objective minimization function. See the <code>minimise</code> module for more information. User-defined loss functions are also supported.</p>
              </div>
            </li>
            <li>
              <b><code>number_of_starts</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>The number of random initialisations for the optimization. Default is <code>1</code>.</p>
              </div>
            </li>
            <li>
              <b><code>initial_guess</code></b>
                  (<code><span title="list">list</span> or <span title="array">array</span> - <span title="like">like</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The initial guess for the optimization. Default is <code>None</code>. If <code>number_of_starts</code> is set, and the <code>initial_guess</code> parameter is 'None', the initial guesses are randomly generated from a uniform distribution.</p>
              </div>
            </li>
            <li>
              <b><code>parallel</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to use parallel processing. Default is <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>cl</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The number of cores to use for parallel processing. Default is <code>None</code>. If <code>None</code>, the number of cores is set to 2.
If <code>cl</code> is set to <code>None</code> and <code>parallel</code> is set to <code>True</code>, the number of cores is set to the number of cores available on the machine.</p>
              </div>
            </li>
            <li>
              <b><code>libraries</code></b>
                  (<code><span title="list">list</span></code>, default:
                      <code>[&#39;numpy&#39;, &#39;pandas&#39;]</code>
)
              –
              <div class="doc-md-description">
                <p>The libraries to import for parallel processing for <code>ipyparallel</code> with the IPython kernel. Default is <code>["numpy", "pandas"]</code></p>
              </div>
            </li>
            <li>
              <b><code>ppt_identifier</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The key in the participant data dictionary that contains the participant identifier. Default is <code>None</code>. Returned in the optimization details.</p>
              </div>
            </li>
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="dict">dict</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments. See the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html"><code>scipy.optimize.minimize</code></a> documentation for what is supported.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p>The data parameter must contain all input to the model, including the observed data. The data parameter can be a pandas DataFrame, a pandas DataFrameGroupBy object, or a list of dictionaries. If the data parameter is a pandas DataFrame, it is assumed that the data needs to be grouped by the participant identifier, <code>ppt_identifier</code>. If the data parameter is a pandas DataFrameGroupBy object, the groups are assumed to be participants. If the data parameter is a list of dictionaries, each dictionary should contain the data for a single participant, including information about the experiment and the results. The observed data for each participant should be included in the dictionary under the key or column 'observed'. The 'observed' key should correspond, both in format and shape, to the 'dependent' variable calculated by the model Wrapper.</p>
<p>The optimization process is repeated <code>number_of_starts</code> times, and only the best-fitting output from the best guess is stored.</p>
</details>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.Minimize.export" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exports the optimization results and fitted parameters as a <code>pandas.DataFrame</code>.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
              –
              <div class="doc-md-description">
                <p>A pandas DataFrame containing the optimization results and fitted parameters.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.Minimize.optimise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimise</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Performs the optimization process.</p>
<p>Returns:
- None</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.Minimize.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">(</span><span class="n">initial_guess</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Resets the optimization results and fitted parameters.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>initial_guess</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to reset the initial guess (generates a new set of random numbers within parameter bounds). Default is <code>True</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>None</code>
              –
              <div class="doc-md-description">
                
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="cpm.optimisation.Bads" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">cpm</span><span class="o">.</span><span class="n">optimisation</span><span class="o">.</span><span class="n">Bads</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minimisation</span><span class="o">=</span><span class="n">minimise</span><span class="o">.</span><span class="n">LogLikelihood</span><span class="o">.</span><span class="n">continuous</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">number_of_starts</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">initial_guess</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cl</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">libraries</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;pandas&#39;</span><span class="p">],</span> <span class="n">ppt_identifier</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents first">


        <p>Class representing the Bayesian Adaptive Direct Search (BADS) optimization algorithm.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>model</code></b>
                  (<code><span title="cpm.cpm.generators.Wrapper">Wrapper</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The model to be optimized.</p>
              </div>
            </li>
            <li>
              <b><code>data</code></b>
                  (<code>(<span title="pandas.DataFrame">DataFrame</span>, <span title="pandas.DataFrameGroupBy">DataFrameGroupBy</span>, <span title="list">list</span>)</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The data used for optimization. If a pd.Dataframe, it is grouped by the <code>ppt_identifier</code>. If it is a pd.DataFrameGroupby, groups are assumed to be participants. An array of dictionaries, where each dictionary contains the data for a single participant, including information about the experiment and the results too. See Notes for more information.</p>
              </div>
            </li>
            <li>
              <b><code>minimisation</code></b>
                  (<code><span title="function">function</span></code>, default:
                      <code><a class="autorefs autorefs-internal" title="continuous(predicted, observed, negative=True, **kwargs)

  
      staticmethod
   (cpm.optimisation.minimise.LogLikelihood.continuous)" href="#cpm.optimisation.minimise.LogLikelihood.continuous">continuous</a></code>
)
              –
              <div class="doc-md-description">
                <p>The loss function for the objective minimization function. Default is <code>minimise.LogLikelihood.continuous</code>. See the <code>minimise</code> module for more information. User-defined loss functions are also supported.</p>
              </div>
            </li>
            <li>
              <b><code>prior</code></b>
              –
              <div class="doc-md-description">
                <p>Whether to include the prior in the optimization. Default is <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>number_of_starts</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>1</code>
)
              –
              <div class="doc-md-description">
                <p>The number of random initialisations for the optimization. Default is <code>1</code>.</p>
              </div>
            </li>
            <li>
              <b><code>initial_guess</code></b>
                  (<code><span title="list">list</span> or <span title="array">array</span> - <span title="like">like</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The initial guess for the optimization. Default is <code>None</code>. If <code>number_of_starts</code> is set, and the <code>initial_guess</code> parameter is 'None', the initial guesses are randomly generated from a uniform distribution.</p>
              </div>
            </li>
            <li>
              <b><code>parallel</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to use parallel processing. Default is <code>False</code>.</p>
              </div>
            </li>
            <li>
              <b><code>cl</code></b>
                  (<code><span title="int">int</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The number of cores to use for parallel processing. Default is <code>None</code>. If <code>None</code>, the number of cores is set to 2.
If <code>cl</code> is set to <code>None</code> and <code>parallel</code> is set to <code>True</code>, the number of cores is set to the number of cores available on the machine.</p>
              </div>
            </li>
            <li>
              <b><code>libraries</code></b>
                  (<code><span title="list">list</span></code>, default:
                      <code>[&#39;numpy&#39;, &#39;pandas&#39;]</code>
)
              –
              <div class="doc-md-description">
                <p>The libraries required for the parallel processing with <code>ipyparallel</code> with the IPython kernel. Default is <code>["numpy", "pandas"]</code>.</p>
              </div>
            </li>
            <li>
              <b><code>ppt_identifier</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The key in the participant data dictionary that contains the participant identifier. Default is <code>None</code>. Returned in the optimization details.</p>
              </div>
            </li>
            <li>
              <b><code>**kwargs</code></b>
                  (<code><span title="dict">dict</span></code>, default:
                      <code>{}</code>
)
              –
              <div class="doc-md-description">
                <p>Additional keyword arguments. See the <a href="https://acerbilab.github.io/pybads/api/classes/bads.html"><code>pybads.bads</code></a> documentation for what is supported.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p>The data parameter must contain all input to the model, including the observed data. The data parameter can be a pandas DataFrame, a pandas DataFrameGroupBy object, or a list of dictionaries. If the data parameter is a pandas DataFrame, it is assumed that the data needs to be grouped by the participant identifier, <code>ppt_identifier</code>. If the data parameter is a pandas DataFrameGroupBy object, the groups are assumed to be participants. If the data parameter is a list of dictionaries, each dictionary should contain the data for a single participant, including information about the experiment and the results. The observed data for each participant should be included in the dictionary under the key or column 'observed'. The 'observed' key should correspond, both in format and shape, to the 'dependent' variable calculated by the model Wrapper.</p>
<p>The optimization process is repeated <code>number_of_starts</code> times, and only the best-fitting output from the best guess is stored.</p>
<p>The BADS algorithm has been designed to handle both deterministic and noisy (stochastic) target functions. A deterministic target function is a target function that returns the same exact probability value for a given dataset and proposed set of parameter values. By contrast, a stochastic target function returns varying probability values for the same input (data and parameters).
The vast majority of models use a deterministic target function. We recommend that users make this explicit to BADS, by providing an <code>options</code> dictionary that includes the key <code>uncertainty_handling</code> set to <code>False</code>.
Please see that <a href="https://acerbilab.github.io/pybads/api/options/bads_options.html">BADS options</a> documentation for more details.</p>
</details>









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.Bads.export" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">export</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Exports the optimization results and fitted parameters as a <code>pandas.DataFrame</code>.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="pandas.DataFrame">DataFrame</span></code>
              –
              <div class="doc-md-description">
                <p>A pandas DataFrame containing the optimization results and fitted parameters.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.Bads.optimise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">optimise</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Performs the optimization process.</p>
<p>Returns:
- None</p>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="cpm.optimisation.Bads.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">(</span><span class="n">initial_guess</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Resets the optimization results and fitted parameters.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>initial_guess</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Whether to reset the initial guess (generates a new set of random numbers within parameter bounds). Default is <code>True</code>.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>None</code>
              –
              <div class="doc-md-description">
                
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>



  </div>

    </div>

</div><h2 id="minimise">minimise</h2>


<div class="doc doc-object doc-class">



<h3 id="cpm.optimisation.minimise.LogLikelihood" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">cpm</span><span class="o">.</span><span class="n">optimisation</span><span class="o">.</span><span class="n">minimise</span><span class="o">.</span><span class="n">LogLikelihood</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents first">











  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="cpm.optimisation.minimise.LogLikelihood.bernoulli" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bernoulli</span><span class="p">(</span><span class="n">predicted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the log likelihood of the predicted values given the observed values for Bernoulli data.</p>
<pre><code>Bernoulli(y|p) = p if y = 1 and 1 - p if y = 0
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>predicted</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The predicted values. It must have the same shape as <code>observed</code>. See Notes for more details.</p>
              </div>
            </li>
            <li>
              <b><code>observed</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The observed values. It must have the same shape as <code>predicted</code>. See Notes for more details.</p>
              </div>
            </li>
            <li>
              <b><code>negative</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Flag indicating whether to return the negative log likelihood.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>The summed log likelihood or negative log likelihood.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p><code>predicted</code> and <code>observed</code> must have the same shape.
<code>observed</code> is a binary variable, so it can only take the values 0 or 1.
<code>predicted</code> must be a value between 0 and 1.
Values are clipped to avoid log(0) and log(1).
If we encounter any non-finite values, we set any log likelihood to the value of np.log(1e-100).</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">LogLikelihood</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">)</span>
<span class="go">1.7350011354094463</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cpm.optimisation.minimise.LogLikelihood.categorical" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">categorical</span><span class="p">(</span><span class="n">predicted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the log likelihood of the predicted values given the observed values for categorical data.</p>
<pre><code>Categorical(y|p) = p_y
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>predicted</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The predicted values. It must have the same shape as <code>observed</code>. See Notes for more details.</p>
              </div>
            </li>
            <li>
              <b><code>observed</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>The observed values. It must have the same shape as <code>predicted</code>. See Notes for more details.</p>
              </div>
            </li>
            <li>
              <b><code>negative</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Flag indicating whether to return the negative log likelihood.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>The log likelihood or negative log likelihood.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<details class="note" open>
  <summary>Notes</summary>
  <p><code>predicted</code> and <code>observed</code> must have the same shape.
<code>observed</code> is a vector of integers starting from 0 (first possible response), where each integer corresponds to the observed value.
If there are two choice options, then observed would have a shape of (n, 2) and predicted would have a shape of (n, 2).
On each row of <code>observed</code>, the array would have a 1 in the column corresponding to the observed value and a 0 in the other column.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">LogLikelihood</span><span class="o">.</span><span class="n">categorical</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">)</span>
<span class="go">1.7350011354094463</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cpm.optimisation.minimise.LogLikelihood.continuous" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">continuous</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the log likelihood of the predicted values given the observed values for continuous data.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>predicted</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The predicted values.</p>
              </div>
            </li>
            <li>
              <b><code>observed</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The observed values.</p>
              </div>
            </li>
            <li>
              <b><code>negative</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Flag indicating whether to return the negative log likelihood.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>The summed log likelihood or negative log likelihood.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">LogLikelihood</span><span class="o">.</span><span class="n">continuous</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">)</span>
<span class="go">1.7350011354094463</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cpm.optimisation.minimise.LogLikelihood.multinomial" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">multinomial</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the log likelihood of the predicted values given the observed values for multinomial data.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>predicted</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The predicted values.</p>
              </div>
            </li>
            <li>
              <b><code>observed</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The observed values.</p>
              </div>
            </li>
            <li>
              <b><code>negative</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Flag indicating whether to return the negative log likelihood.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>The summed log likelihood or negative summed log likelihood.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate log likelihood</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ll_float</span> <span class="o">=</span> <span class="n">LogLikelihood</span><span class="o">.</span><span class="n">multinomial</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Log Likelihood (multinomial):&quot;</span><span class="p">,</span> <span class="n">ll</span><span class="p">)</span>
<span class="go">Log Likelihood (multinomial): 4.596597454123483</span>
</code></pre></div>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cpm.optimisation.minimise.LogLikelihood.product" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">product</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="n">negative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the log likelihood of the predicted values given the observed values for continuous data, according to the following equation:</p>
<pre><code>likelihood = sum(observed * log(predicted))
</code></pre>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>predicted</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The predicted values.</p>
              </div>
            </li>
            <li>
              <b><code>observed</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The observed values.</p>
              </div>
            </li>
            <li>
              <b><code>negative</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>Flag indicating whether to return the negative log likelihood.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>The summed log likelihood or negative log likelihood.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Sample data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</code></pre></div>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate log likelihood</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ll_float</span> <span class="o">=</span> <span class="n">LogLikelihood</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Log Likelihood :&quot;</span><span class="p">,</span> <span class="n">ll_float</span><span class="p">)</span>
<span class="go">Log Likelihood : 18.314715666079106</span>
</code></pre></div>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cpm.optimisation.minimise.Distance" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">cpm</span><span class="o">.</span><span class="n">optimisation</span><span class="o">.</span><span class="n">minimise</span><span class="o">.</span><span class="n">Distance</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents first">











  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="cpm.optimisation.minimise.Distance.MSE" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">MSE</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the Mean Squared Errors (EDE).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>predicted</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The predicted values.</p>
              </div>
            </li>
            <li>
              <b><code>observed</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The observed values.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>The Euclidean distance.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cpm.optimisation.minimise.Distance.RMSE" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">RMSE</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the Root Mean Squared Errors (RMSE).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>predicted</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The predicted values.</p>
              </div>
            </li>
            <li>
              <b><code>observed</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The observed values.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>The Root Mean Squared Errors.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cpm.optimisation.minimise.Distance.SSE" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">SSE</span><span class="p">(</span><span class="n">predicted</span><span class="p">,</span> <span class="n">observed</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Compute the sum of squared errors (SSE).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>predicted</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The predicted values.</p>
              </div>
            </li>
            <li>
              <b><code>observed</code></b>
                  (<code><span title="array">array</span> - <span title="like">like</span></code>)
              –
              <div class="doc-md-description">
                <p>The observed values.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>The sum of squared errors.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="cpm.optimisation.minimise.Bayesian" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">cpm</span><span class="o">.</span><span class="n">optimisation</span><span class="o">.</span><span class="n">minimise</span><span class="o">.</span><span class="n">Bayesian</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents first">











  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="cpm.optimisation.minimise.Bayesian.AIC" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">AIC</span><span class="p">(</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the Akaike Information Criterion (AIC).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>likelihood</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>The log likelihood value.</p>
              </div>
            </li>
            <li>
              <b><code>n</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The number of data points.</p>
              </div>
            </li>
            <li>
              <b><code>k</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The number of parameters.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>The AIC value.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="cpm.optimisation.minimise.Bayesian.BIC" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">BIC</span><span class="p">(</span><span class="n">likelihood</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-staticmethod"><code>staticmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the Bayesian Information Criterion (BIC).</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>likelihood</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>The log likelihood value.</p>
              </div>
            </li>
            <li>
              <b><code>n</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The number of data points.</p>
              </div>
            </li>
            <li>
              <b><code>k</code></b>
                  (<code><span title="int">int</span></code>)
              –
              <div class="doc-md-description">
                <p>The number of parameters.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code><span title="float">float</span></code>
              –
              <div class="doc-md-description">
                <p>The BIC value.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../generators/" class="btn btn-neutral float-left" title="cpm.generators"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../hierarchical/" class="btn btn-neutral float-right" title="cpm.hierarchical">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../generators/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../hierarchical/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
